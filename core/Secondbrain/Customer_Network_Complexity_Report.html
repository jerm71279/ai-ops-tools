<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Network Complexity Analysis - OberaConnect</title>
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2c5282;
            --accent: #3182ce;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --critical: #9b2c2c;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        .header h1 { font-size: 2.2rem; margin-bottom: 10px; font-weight: 600; }
        .header .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .header .date { margin-top: 15px; font-size: 0.9rem; opacity: 0.8; }
        .logo-bar {
            background: white;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--accent);
        }
        .logo-bar .company { font-weight: 700; font-size: 1.3rem; color: var(--primary); }
        .logo-bar .confidential {
            background: var(--danger);
            color: white;
            padding: 5px 15px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 30px; }

        /* Executive Summary */
        .exec-summary {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .exec-summary h2 {
            color: var(--primary);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .key-findings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        .finding-card {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid var(--accent);
        }
        .finding-card .number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
        }
        .finding-card .label {
            color: #718096;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .finding-card.critical { border-left-color: var(--danger); }
        .finding-card.critical .number { color: var(--danger); }
        .finding-card.warning { border-left-color: var(--warning); }
        .finding-card.warning .number { color: var(--warning); }
        .finding-card.success { border-left-color: var(--success); }
        .finding-card.success .number { color: var(--success); }

        /* Risk Matrix */
        .risk-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .risk-section h2 {
            color: var(--primary);
            margin-bottom: 20px;
        }
        .risk-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .risk-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        .risk-table td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        .risk-table tr:hover { background: #f7fafc; }
        .risk-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .risk-critical { background: #fed7d7; color: #c53030; }
        .risk-high { background: #feebc8; color: #c05621; }
        .risk-medium { background: #fefcbf; color: #975a16; }
        .risk-low { background: #c6f6d5; color: #276749; }

        /* Complexity Bar */
        .complexity-bar {
            width: 100%;
            height: 24px;
            background: #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }
        .complexity-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 0.5s ease;
        }
        .complexity-fill.critical { background: linear-gradient(90deg, #e53e3e, #c53030); }
        .complexity-fill.high { background: linear-gradient(90deg, #ed8936, #dd6b20); }
        .complexity-fill.medium { background: linear-gradient(90deg, #ecc94b, #d69e2e); }
        .complexity-fill.low { background: linear-gradient(90deg, #48bb78, #38a169); }

        /* Customer Detail Cards */
        .customer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        .customer-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .customer-card-header {
            padding: 20px;
            color: white;
        }
        .customer-card-header.critical { background: linear-gradient(135deg, #e53e3e, #c53030); }
        .customer-card-header.high { background: linear-gradient(135deg, #ed8936, #dd6b20); }
        .customer-card-header.medium { background: linear-gradient(135deg, #ecc94b, #d69e2e); }
        .customer-card-header.low { background: linear-gradient(135deg, #48bb78, #38a169); }
        .customer-card-header h3 { font-size: 1.2rem; margin-bottom: 5px; }
        .customer-card-header .device-type { opacity: 0.9; font-size: 0.9rem; }
        .customer-card-body { padding: 20px; }
        .customer-stat {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .customer-stat:last-child { border-bottom: none; }
        .customer-stat .label { color: #718096; }
        .customer-stat .value { font-weight: 600; color: var(--primary); }

        /* Recommendations */
        .recommendations {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .recommendations h2 {
            color: var(--primary);
            margin-bottom: 20px;
        }
        .rec-item {
            display: flex;
            gap: 15px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--accent);
        }
        .rec-item.urgent { border-left-color: var(--danger); }
        .rec-number {
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }
        .rec-item.urgent .rec-number { background: var(--danger); }
        .rec-content h4 { color: var(--primary); margin-bottom: 5px; }
        .rec-content p { color: #4a5568; font-size: 0.95rem; }

        /* Chart visualization */
        .chart-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        .bar-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .bar-label {
            width: 150px;
            font-size: 0.9rem;
            color: #4a5568;
        }
        .bar-container {
            flex: 1;
            height: 30px;
            background: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        .bar-value {
            height: 100%;
            border-radius: 6px;
            display: flex;
            align-items: center;
            padding-left: 10px;
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .footer {
            text-align: center;
            padding: 30px;
            color: #718096;
            font-size: 0.85rem;
            border-top: 1px solid #e2e8f0;
            margin-top: 30px;
        }
        .print-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .print-btn:hover { background: var(--secondary); }
        @media print {
            .print-btn { display: none; }
            body { background: white; }
            .customer-card, .risk-section, .exec-summary, .recommendations {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <div class="logo-bar">
        <div class="company">OberaConnect</div>
        <div class="confidential">INTERNAL - MANAGEMENT REVIEW</div>
    </div>

    <div class="header">
        <h1>Customer Network Complexity Analysis</h1>
        <div class="subtitle">Infrastructure Assessment & Risk Evaluation Report</div>
        <div class="date">Generated: December 9, 2025</div>
    </div>

    <div class="container">
        <!-- Executive Summary -->
        <div class="exec-summary">
            <h2>Executive Summary</h2>
            <p>This report analyzes the network infrastructure complexity across OberaConnect's managed customer base. The assessment evaluates VLAN segmentation, device counts, and overall architecture complexity to identify customers requiring infrastructure upgrades or enhanced support resources.</p>

            <div class="key-findings">
                <div class="finding-card critical">
                    <div class="number">1</div>
                    <div class="label">Critical Complexity<br>(80+ VLANs)</div>
                </div>
                <div class="finding-card warning">
                    <div class="number">0</div>
                    <div class="label">High Complexity<br>(40-79 VLANs)</div>
                </div>
                <div class="finding-card">
                    <div class="number">0</div>
                    <div class="label">Medium Complexity<br>(10-39 VLANs)</div>
                </div>
                <div class="finding-card success">
                    <div class="number">6</div>
                    <div class="label">Standard Complexity<br>(&lt;10 VLANs)</div>
                </div>
            </div>

            <p style="margin-top: 20px;"><strong>Key Finding:</strong> Saint Annes Terrance represents the highest complexity environment in our portfolio with 89 VLANs and 129 network devices. This deployment is currently operating on MikroTik infrastructure which, while capable, creates management overhead due to separate tooling from our standard UniFi ecosystem.</p>
        </div>

        <!-- Risk Assessment -->
        <div class="risk-section">
            <h2>Customer Risk Assessment</h2>
            <table class="risk-table">
                <thead>
                    <tr>
                        <th>Customer</th>
                        <th>Device Type</th>
                        <th>VLANs</th>
                        <th>Network Devices</th>
                        <th>Complexity</th>
                        <th>Risk Level</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Saint Annes Terrance</strong></td>
                        <td>MikroTik CCR2116 + UniFi</td>
                        <td>89</td>
                        <td>129</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill critical" style="width: 95%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-critical">CRITICAL</span></td>
                    </tr>
                    <tr>
                        <td>SFWB - Main Office</td>
                        <td>SonicWall TZ 270</td>
                        <td>~5</td>
                        <td>~15</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill low" style="width: 15%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>SFWB - Rockwell</td>
                        <td>SonicWall TZ 270</td>
                        <td>~5</td>
                        <td>~10</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill low" style="width: 12%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>SFWB - WTRD</td>
                        <td>SonicWall TZ 270</td>
                        <td>~5</td>
                        <td>~10</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill low" style="width: 12%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>Celebration Church</td>
                        <td>MikroTik</td>
                        <td>0</td>
                        <td>~8</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill low" style="width: 8%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>Clauger Rebuild Shop</td>
                        <td>MikroTik</td>
                        <td>0</td>
                        <td>~5</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill low" style="width: 5%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-low">LOW</span></td>
                    </tr>
                    <tr>
                        <td>Setco</td>
                        <td>Mixed</td>
                        <td>TBD</td>
                        <td>TBD</td>
                        <td>
                            <div class="complexity-bar">
                                <div class="complexity-fill medium" style="width: 0%"></div>
                            </div>
                        </td>
                        <td><span class="risk-badge risk-medium">PENDING</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- VLAN Distribution Chart -->
        <div class="chart-section">
            <h2>VLAN Distribution by Customer</h2>
            <div class="bar-chart">
                <div class="bar-item">
                    <div class="bar-label">Saint Annes</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 89%; background: linear-gradient(90deg, #e53e3e, #c53030);">89 VLANs</div>
                    </div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">SFWB Sites</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 5%; background: linear-gradient(90deg, #48bb78, #38a169);">~5</div>
                    </div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">Celebration Church</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 2%; background: linear-gradient(90deg, #48bb78, #38a169);">0</div>
                    </div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">Clauger</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 2%; background: linear-gradient(90deg, #48bb78, #38a169);">0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Critical Customer Deep Dive -->
        <div class="risk-section">
            <h2>Critical Complexity: Saint Annes Terrance</h2>
            <p style="margin-bottom: 20px;">Multi-dwelling unit (MDU) property requiring per-unit network isolation. Current infrastructure is functional but creates operational overhead.</p>

            <div class="customer-grid">
                <div class="customer-card">
                    <div class="customer-card-header critical">
                        <h3>Current State</h3>
                        <div class="device-type">MikroTik CCR2116-12G-4S+</div>
                    </div>
                    <div class="customer-card-body">
                        <div class="customer-stat">
                            <span class="label">Total VLANs</span>
                            <span class="value">89</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Infrastructure VLANs</span>
                            <span class="value">5</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Unit VLANs</span>
                            <span class="value">84</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Network Devices</span>
                            <span class="value">129</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">48-Port Switches</span>
                            <span class="value">Multiple (UniFi)</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">8-Port Switches</span>
                            <span class="value">Several (UniFi)</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Access Points</span>
                            <span class="value">UniFi U7 Series</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Buildings</span>
                            <span class="value">5</span>
                        </div>
                    </div>
                </div>

                <div class="customer-card">
                    <div class="customer-card-header" style="background: linear-gradient(135deg, var(--accent), var(--secondary));">
                        <h3>Proposed State</h3>
                        <div class="device-type">UniFi Dream Machine Pro</div>
                    </div>
                    <div class="customer-card-body">
                        <div class="customer-stat">
                            <span class="label">Gateway</span>
                            <span class="value">UDM-Pro</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">VLAN Capacity</span>
                            <span class="value">100+ (sufficient)</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Throughput</span>
                            <span class="value">3.5 Gbps IDS/IPS</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Management</span>
                            <span class="value">Single Dashboard</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Device Visibility</span>
                            <span class="value">All 129 devices</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Migration Status</span>
                            <span class="value" style="color: var(--warning);">Planned</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">Est. Hardware Cost</span>
                            <span class="value">~$379</span>
                        </div>
                        <div class="customer-stat">
                            <span class="label">ROI</span>
                            <span class="value" style="color: var(--success);">Reduced Support Hours</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommendations -->
        <div class="recommendations">
            <h2>Strategic Recommendations</h2>

            <div class="rec-item urgent">
                <div class="rec-number">1</div>
                <div class="rec-content">
                    <h4>Migrate Saint Annes to UniFi Dream Machine Pro</h4>
                    <p>Replace MikroTik CCR2116 with UDM-Pro to unify management of all 129 network devices under single dashboard. Existing UniFi switches and APs will integrate seamlessly. Bulk configuration script is ready for deployment.</p>
                </div>
            </div>

            <div class="rec-item">
                <div class="rec-number">2</div>
                <div class="rec-content">
                    <h4>Complete Keeper Config Audit</h4>
                    <p>Pull remaining customer MikroTik and SonicWall configurations from Keeper Security vault to identify other potentially complex environments requiring attention.</p>
                </div>
            </div>

            <div class="rec-item">
                <div class="rec-number">3</div>
                <div class="rec-content">
                    <h4>Standardize on UniFi Ecosystem</h4>
                    <p>For customers with existing UniFi switches/APs (like Saint Annes), prioritize migrating edge routing to UniFi gateways to reduce tooling complexity and support overhead.</p>
                </div>
            </div>

            <div class="rec-item">
                <div class="rec-number">4</div>
                <div class="rec-content">
                    <h4>Establish Complexity Thresholds</h4>
                    <p>Define service tier thresholds based on VLAN count: Standard (&lt;10), Advanced (10-50), Enterprise (50+). Enterprise tier customers should have dedicated support allocation and proactive monitoring.</p>
                </div>
            </div>
        </div>

        <!-- Device Distribution -->
        <div class="chart-section">
            <h2>Infrastructure Platform Distribution</h2>
            <div class="bar-chart">
                <div class="bar-item">
                    <div class="bar-label">MikroTik</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 45%; background: linear-gradient(90deg, #667eea, #764ba2);">3 Customers</div>
                    </div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">SonicWall</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 45%; background: linear-gradient(90deg, #f093fb, #f5576c);">3 Sites</div>
                    </div>
                </div>
                <div class="bar-item">
                    <div class="bar-label">UniFi (Full Stack)</div>
                    <div class="bar-container">
                        <div class="bar-value" style="width: 15%; background: linear-gradient(90deg, #4facfe, #00f2fe);">Pending Migration</div>
                    </div>
                </div>
            </div>
            <p style="margin-top: 20px; color: #718096; font-size: 0.9rem;">Note: Saint Annes has UniFi switches/APs but MikroTik gateway. Full UniFi stack pending UDM-Pro migration.</p>
        </div>

        <!-- Appendix -->
        <div class="risk-section">
            <h2>Appendix: Data Sources</h2>
            <table class="risk-table">
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Local Config Files</td>
                        <td>MikroTik .rsc, SonicWall .exp</td>
                        <td><span class="risk-badge risk-low">Analyzed</span></td>
                    </tr>
                    <tr>
                        <td>Keeper Security Vault</td>
                        <td>Customer Config Attachments</td>
                        <td><span class="risk-badge risk-medium">Pending Pull</span></td>
                    </tr>
                    <tr>
                        <td>SharePoint Technical Docs</td>
                        <td>Network Documentation</td>
                        <td><span class="risk-badge risk-low">Available</span></td>
                    </tr>
                    <tr>
                        <td>NinjaOne RMM</td>
                        <td>Device Inventory</td>
                        <td><span class="risk-badge risk-medium">Not Integrated</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="footer">
            <p><strong>OberaConnect</strong> | Customer Network Complexity Analysis</p>
            <p>Report generated December 9, 2025 | Confidential - Internal Use Only</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">To update this report with additional customer data, run: <code>./venv/bin/python3 keeper_config_puller.py</code></p>
        </div>
    </div>

    <button class="print-btn" onclick="window.print()">
        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
            <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1z"/>
            <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2H5zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4V3zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2H5zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1z"/>
        </svg>
        Print / Export PDF
    </button>
</body>
</html>
